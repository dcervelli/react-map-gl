{"version":3,"sources":["../../../src/components/interactive-map.js"],"names":["PureComponent","createElement","PropTypes","StaticMap","MAPBOX_LIMITS","WebMercatorViewport","TransitionManager","getInteractiveLayerIds","EventManager","MapControls","config","deprecateWarn","propTypes","Object","assign","maxZoom","number","minZoom","maxPitch","minPitch","onViewStateChange","func","onViewportChange","onInteractionStateChange","transitionDuration","transitionInterpolator","object","transitionInterruption","transitionEasing","onTransitionStart","onTransitionInterrupt","onTransitionEnd","scrollZoom","bool","dragPan","dragRotate","doubleClickZoom","touchZoom","touchRotate","keyboard","onHover","onClick","onContextMenu","touchAction","string","clickRadius","getCursor","mapControls","shape","events","arrayOf","handleEvent","getDefaultCursor","isDragging","isHovering","CURSOR","GRABBING","POINTER","GRAB","defaultProps","event","preventDefault","childContextTypes","viewport","instanceOf","eventManager","InteractiveMap","supported","props","_map","getMap","geometry","options","queryRenderedFeatures","interactionState","state","setState","viewState","oldViewState","onChangeViewport","pos","_getPos","features","_getFeatures","radius","length","lngLat","unproject","ref","_eventManager","setElement","_mapControls","legacyBlockScroll","_updateQueryParams","mapStyle","on","mousemove","_onMouseMove","click","_onMouseClick","contextmenu","_onContextMenu","_setControllerProps","nextProps","isInteractive","Boolean","_onViewportChange","onStateChange","_onInteractionStateChange","setOptions","size","bbox","_queryParams","interactiveLayerIds","layers","offsetCenter","x","y","width","height","eventCanvasStyle","position","cursor","key","_eventCanvasLoaded","style","_staticMapLoaded","children","displayName"],"mappings":"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","sourcesContent":["import {PureComponent, createElement} from 'react';\nimport PropTypes from 'prop-types';\n\nimport StaticMap from './static-map';\nimport {MAPBOX_LIMITS} from '../utils/map-state';\nimport WebMercatorViewport from 'viewport-mercator-project';\n\nimport TransitionManager from '../utils/transition-manager';\nimport {getInteractiveLayerIds} from '../utils/style-utils';\n\nimport {EventManager} from 'mjolnir.js';\nimport MapControls from '../utils/map-controls';\nimport config from '../config';\nimport deprecateWarn from '../utils/deprecate-warn';\n\nconst propTypes = Object.assign({}, StaticMap.propTypes, {\n  // Additional props on top of StaticMap\n\n  /** Viewport constraints */\n  // Max zoom level\n  maxZoom: PropTypes.number,\n  // Min zoom level\n  minZoom: PropTypes.number,\n  // Max pitch in degrees\n  maxPitch: PropTypes.number,\n  // Min pitch in degrees\n  minPitch: PropTypes.number,\n\n  // Callbacks fired when the user interacted with the map. The object passed to the callbacks\n  // contains viewport properties such as `longitude`, `latitude`, `zoom` etc.\n  onViewStateChange: PropTypes.func,\n  onViewportChange: PropTypes.func,\n  onInteractionStateChange: PropTypes.func,\n\n  /** Viewport transition **/\n  // transition duration for viewport change\n  transitionDuration: PropTypes.number,\n  // TransitionInterpolator instance, can be used to perform custom transitions.\n  transitionInterpolator: PropTypes.object,\n  // type of interruption of current transition on update.\n  transitionInterruption: PropTypes.number,\n  // easing function\n  transitionEasing: PropTypes.func,\n  // transition status update functions\n  onTransitionStart: PropTypes.func,\n  onTransitionInterrupt: PropTypes.func,\n  onTransitionEnd: PropTypes.func,\n\n  /** Enables control event handling */\n  // Scroll to zoom\n  scrollZoom: PropTypes.bool,\n  // Drag to pan\n  dragPan: PropTypes.bool,\n  // Drag to rotate\n  dragRotate: PropTypes.bool,\n  // Double click to zoom\n  doubleClickZoom: PropTypes.bool,\n  // Multitouch zoom\n  touchZoom: PropTypes.bool,\n  // Multitouch rotate\n  touchRotate: PropTypes.bool,\n  // Keyboard\n  keyboard: PropTypes.bool,\n\n /**\n    * Called when the map is hovered over.\n    * @callback\n    * @param {Object} event - The mouse event.\n    * @param {[Number, Number]} event.lngLat - The coordinates of the pointer\n    * @param {Array} event.features - The features under the pointer, using Mapbox's\n    * queryRenderedFeatures API:\n    * https://www.mapbox.com/mapbox-gl-js/api/#Map#queryRenderedFeatures\n    * To make a layer interactive, set the `interactive` property in the\n    * layer style to `true`. See Mapbox's style spec\n    * https://www.mapbox.com/mapbox-gl-style-spec/#layer-interactive\n    */\n  onHover: PropTypes.func,\n  /**\n    * Called when the map is clicked.\n    * @callback\n    * @param {Object} event - The mouse event.\n    * @param {[Number, Number]} event.lngLat - The coordinates of the pointer\n    * @param {Array} event.features - The features under the pointer, using Mapbox's\n    * queryRenderedFeatures API:\n    * https://www.mapbox.com/mapbox-gl-js/api/#Map#queryRenderedFeatures\n    * To make a layer interactive, set the `interactive` property in the\n    * layer style to `true`. See Mapbox's style spec\n    * https://www.mapbox.com/mapbox-gl-style-spec/#layer-interactive\n    */\n  onClick: PropTypes.func,\n  /**\n    * Called when the context menu is activated.\n    */\n  onContextMenu: PropTypes.func,\n\n  /** Custom touch-action CSS for the event canvas. Defaults to 'none' */\n  touchAction: PropTypes.string,\n\n  /** Radius to detect features around a clicked point. Defaults to 0. */\n  clickRadius: PropTypes.number,\n\n  /** Accessor that returns a cursor style to show interactive state */\n  getCursor: PropTypes.func,\n\n  // A map control instance to replace the default map controls\n  // The object must expose one property: `events` as an array of subscribed\n  // event names; and two methods: `setState(state)` and `handle(event)`\n  mapControls: PropTypes.shape({\n    events: PropTypes.arrayOf(PropTypes.string),\n    handleEvent: PropTypes.func\n  })\n});\n\nconst getDefaultCursor = ({isDragging, isHovering}) => isDragging ?\n  config.CURSOR.GRABBING :\n  (isHovering ? config.CURSOR.POINTER : config.CURSOR.GRAB);\n\nconst defaultProps = Object.assign({},\n  StaticMap.defaultProps, MAPBOX_LIMITS, TransitionManager.defaultProps,\n  {\n    onViewStateChange: null,\n    onViewportChange: null,\n    onClick: null,\n    onHover: null,\n    onContextMenu: event => event.preventDefault(),\n\n    scrollZoom: true,\n    dragPan: true,\n    dragRotate: true,\n    doubleClickZoom: true,\n\n    touchAction: 'none',\n    clickRadius: 0,\n    getCursor: getDefaultCursor\n  }\n);\n\nconst childContextTypes = {\n  viewport: PropTypes.instanceOf(WebMercatorViewport),\n  isDragging: PropTypes.bool,\n  eventManager: PropTypes.object\n};\n\nexport default class InteractiveMap extends PureComponent {\n\n  static supported() {\n    return StaticMap.supported();\n  }\n\n  constructor(props) {\n    super(props);\n    // Check for deprecated props\n    deprecateWarn(props);\n\n    this.state = {\n      // Whether the cursor is down\n      isDragging: false,\n      // Whether the cursor is over a clickable feature\n      isHovering: false\n    };\n\n    // If props.mapControls is not provided, fallback to default MapControls instance\n    // Cannot use defaultProps here because it needs to be per map instance\n    this._mapControls = props.mapControls || new MapControls();\n\n    this._eventManager = new EventManager(null, {\n      legacyBlockScroll: false,\n      touchAction: props.touchAction\n    });\n\n    this._updateQueryParams(props.mapStyle);\n  }\n\n  getChildContext() {\n    return {\n      viewport: new WebMercatorViewport(this.props),\n      isDragging: this.state.isDragging,\n      eventManager: this._eventManager\n    };\n  }\n\n  componentDidMount() {\n    const eventManager = this._eventManager;\n\n    // Register additional event handlers for click and hover\n    eventManager.on({\n      mousemove: this._onMouseMove,\n      click: this._onMouseClick,\n      contextmenu: this._onContextMenu\n    });\n\n    this._setControllerProps(this.props);\n  }\n\n  componentWillUpdate(nextProps) {\n    if (this.props.mapStyle !== nextProps.mapStyle) {\n      this._updateQueryParams(nextProps.mapStyle);\n    }\n\n    this._setControllerProps(nextProps);\n  }\n\n  getMap = () => {\n    return this._map ? this._map.getMap() : null;\n  }\n\n  queryRenderedFeatures = (geometry, options) => {\n    return this._map.queryRenderedFeatures(geometry, options);\n  }\n\n  _setControllerProps(props) {\n    props = Object.assign({}, props, props.viewState, {\n      isInteractive: Boolean(props.onViewStateChange ||\n        props.onViewportChange || props.onChangeViewport),\n      onViewportChange: this._onViewportChange,\n      onStateChange: this._onInteractionStateChange,\n      eventManager: this._eventManager\n    });\n\n    this._mapControls.setOptions(props);\n  }\n\n  _getFeatures({pos, radius}) {\n    let features;\n    if (radius) {\n      // Radius enables point features, like marker symbols, to be clicked.\n      const size = radius;\n      const bbox = [[pos[0] - size, pos[1] + size], [pos[0] + size, pos[1] - size]];\n      features = this._map.queryRenderedFeatures(bbox, this._queryParams);\n    } else {\n      features = this._map.queryRenderedFeatures(pos, this._queryParams);\n    }\n    return features;\n  }\n\n  // Hover and click only query layers whose interactive property is true\n  _updateQueryParams(mapStyle) {\n    const interactiveLayerIds = getInteractiveLayerIds(mapStyle);\n    this._queryParams = {layers: interactiveLayerIds};\n  }\n\n  _onInteractionStateChange = (interactionState) => {\n    const {isDragging = false} = interactionState;\n    if (isDragging !== this.state.isDragging) {\n      this.setState({isDragging});\n    }\n\n    const {onInteractionStateChange} = this.props;\n    if (onInteractionStateChange) {\n      onInteractionStateChange(interactionState);\n    }\n  }\n\n  _onViewportChange = (viewState, interactionState, oldViewState) => {\n    const onViewStateChange = this.props.onViewStateChange;\n    const onViewportChange = this.props.onViewportChange || this.props.onChangeViewport;\n\n    if (onViewStateChange) {\n      onViewStateChange({viewState, interactionState, oldViewState});\n    }\n    if (onViewportChange) {\n      onViewportChange(viewState, interactionState, oldViewState);\n    }\n  }\n\n  // HOVER AND CLICK\n  _getPos(event) {\n    const {offsetCenter: {x, y}} = event;\n    return [x, y];\n  }\n\n  _onMouseMove = (event) => {\n    if (!this.state.isDragging) {\n      const pos = this._getPos(event);\n      const features = this._getFeatures({pos, radius: this.props.clickRadius});\n\n      const isHovering = features && features.length > 0;\n      if (isHovering !== this.state.isHovering) {\n        this.setState({isHovering});\n      }\n\n      if (this.props.onHover) {\n        const viewport = new WebMercatorViewport(this.props);\n        event.lngLat = viewport.unproject(pos);\n        event.features = features;\n\n        this.props.onHover(event);\n      }\n    }\n  }\n\n  _onMouseClick = (event) => {\n    if (this.props.onClick) {\n      const pos = this._getPos(event);\n      const viewport = new WebMercatorViewport(this.props);\n      event.lngLat = viewport.unproject(pos);\n      event.features = this._getFeatures({pos, radius: this.props.clickRadius});\n\n      this.props.onClick(event);\n    }\n  }\n\n  _onContextMenu = (event) => {\n    if (this.props.onContextMenu) {\n      this.props.onContextMenu(event);\n    }\n  }\n\n  _eventCanvasLoaded = (ref) => {\n    // This will be called with `null` after unmount, releasing event manager resource\n    this._eventManager.setElement(ref);\n  }\n\n  _staticMapLoaded = (ref) => {\n    this._map = ref;\n  }\n\n  render() {\n    const {width, height, getCursor} = this.props;\n\n    const eventCanvasStyle = {\n      width,\n      height,\n      position: 'relative',\n      cursor: getCursor(this.state)\n    };\n\n    return (\n      createElement('div', {\n        key: 'map-controls',\n        ref: this._eventCanvasLoaded,\n        style: eventCanvasStyle\n      },\n        createElement(StaticMap, Object.assign({}, this.props,\n          {\n            ref: this._staticMapLoaded,\n            children: this.props.children\n          }\n        ))\n      )\n    );\n  }\n}\n\nInteractiveMap.displayName = 'InteractiveMap';\nInteractiveMap.propTypes = propTypes;\nInteractiveMap.defaultProps = defaultProps;\nInteractiveMap.childContextTypes = childContextTypes;\n"],"file":"interactive-map.js"}