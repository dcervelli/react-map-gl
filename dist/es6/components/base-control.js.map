{"version":3,"sources":["../../../src/components/base-control.js"],"names":["Component","PropTypes","WebMercatorViewport","propTypes","captureScroll","bool","captureDrag","captureClick","captureDoubleClick","defaultProps","contextTypes","viewport","instanceOf","isDragging","eventManager","object","BaseControl","constructor","props","ref","_containerRef","context","events","_events","off","wheel","_onScroll","panstart","_onDragStart","click","_onClick","dblclick","_onDoubleClick","on","evt","stopPropagation","componentWillUnmount","render"],"mappings":"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","sourcesContent":["// Copyright (c) 2015 Uber Technologies, Inc.\n\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\nimport {Component} from 'react';\nimport PropTypes from 'prop-types';\nimport WebMercatorViewport from 'viewport-mercator-project';\n\nconst propTypes = {\n  /** Event handling */\n  captureScroll: PropTypes.bool,\n  // Stop map pan & rotate\n  captureDrag: PropTypes.bool,\n  // Stop map click\n  captureClick: PropTypes.bool,\n  // Stop map double click\n  captureDoubleClick: PropTypes.bool\n};\n\nconst defaultProps = {\n  captureScroll: false,\n  captureDrag: true,\n  captureClick: true,\n  captureDoubleClick: true\n};\n\nconst contextTypes = {\n  viewport: PropTypes.instanceOf(WebMercatorViewport),\n  isDragging: PropTypes.bool,\n  eventManager: PropTypes.object\n};\n\n/*\n * PureComponent doesn't update when context changes.\n * The only way is to implement our own shouldComponentUpdate here. Considering\n * the parent component (StaticMap or InteractiveMap) is pure, and map re-render\n * is almost always triggered by a viewport change, we almost definitely need to\n * recalculate the marker's position when the parent re-renders.\n */\nexport default class BaseControl extends Component {\n\n  constructor(props) {\n    super(props);\n\n    this._events = null;\n    this._containerRef = null;\n  }\n\n  componentWillUnmount() {\n    const {eventManager} = this.context;\n    if (eventManager && this._events) {\n      eventManager.off(this._events);\n    }\n  }\n\n  _onContainerLoad = (ref) => {\n    this._containerRef = ref;\n\n    const {eventManager} = this.context;\n\n    // Return early if no eventManager is found\n    if (!eventManager) {\n      return;\n    }\n\n    let events = this._events;\n\n    // Remove all previously registered events\n    if (events) {\n      eventManager.off(events);\n      events = null;\n    }\n\n    if (ref) {\n      // container is mounted: register events for this element\n      events = {\n        wheel: this._onScroll,\n        panstart: this._onDragStart,\n        click: this._onClick,\n        dblclick: this._onDoubleClick\n      };\n\n      eventManager.on(events, ref);\n    }\n\n    this._events = events;\n  }\n\n  _onScroll = (evt) => {\n    if (this.props.captureScroll) {\n      evt.stopPropagation();\n    }\n  }\n\n  _onDragStart = (evt) => {\n    if (this.props.captureDrag) {\n      evt.stopPropagation();\n    }\n  }\n\n  _onClick = (evt) => {\n    if (this.props.captureClick) {\n      evt.stopPropagation();\n    }\n  }\n\n  _onDoubleClick = (evt) => {\n    if (this.props.captureDoubleClick) {\n      evt.stopPropagation();\n    }\n  }\n\n  render() {\n    return null;\n  }\n\n}\n\nBaseControl.propTypes = propTypes;\nBaseControl.defaultProps = defaultProps;\nBaseControl.contextTypes = contextTypes;\n"],"file":"base-control.js"}